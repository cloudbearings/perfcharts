function ChartGeneration(c){ChartGeneration.eventHandlers={toggleSeries:function(A,C,y,x){if(C<0){return}var B=ChartGeneration.data[C].charts[y];var z=B.series[x];var w=false;if(z._show===false){w=true}z._show=w;if(!z.lines){z.lines={show:true}}z.lines.show=w?z._showLines:false;if(!z.bars){z.bars={show:false}}z.bars.show=w?z._showBars:false;if(!z.points){z.points={show:false}}z.points.show=w?z._showPoints:false;p(B.plot.getPlaceholder(),B.plot,B,true)}};ChartGeneration.data=[];ChartGeneration.compositeReport={};function h(w){var x=ChartGeneration.data;if(w>=x.length){return}x[w]._index=w;l(c(".report"),x[w])}function l(C,w){C.children(".report_title").text(w.title);var B=C.children(".charts");var A=w.charts;B.html("");for(var y=0;y<A.length;++y){var z=A[y];var x=c("<div class='chart'/>");B.append(x);z._index=y;z._reportIndex=w._index;if(z.chartType==="JmeterSummaryChart"){b(x,z)}else{if(z.chartType==="TABLE"){v(x,z)}else{m(x,z)}}}}function v(B,C){B.append(c("<h3 class='chart_title'/>").text(C.title)).append(c("<h4 class='chart_subtitle'/>").text(C.subtitle));var G=c("<table class='chart_table'/>").appendTo(B);if(C.key){G.attr("data-key",C.key)}if(C.header){var w=c("<tr/>").appendTo(c("<thead/>").appendTo(G));for(var z=0;z<C.header.length;++z){c("<th/>").text(C.header[z]).appendTo(w)}}if(C.topRows){var A=c('<tbody class="tablesorter-no-sort"/>').appendTo(G);for(var z=0;z<C.topRows.length;++z){var E=c("<tr/>").appendTo(A);var H=C.topRows[z];for(var y=0;y<H.length;++y){var F=H[y];i(H[y]).appendTo(E)}}}if(C.rows){var x=c("<tbody/>").appendTo(G);for(var z=0;z<C.rows.length;++z){var E=c("<tr/>").appendTo(x);var H=C.rows[z];for(var y=0;y<H.length;++y){var F=H[y];i(H[y]).appendTo(E)}}}if(C.bottomRows){var D=c('<tbody class="tablesorter-no-sort"/>').appendTo(G);for(var z=0;z<C.bottomRows.length;++z){var E=c("<tr/>").appendTo(D);var H=C.bottomRows[z];for(var y=0;y<H.length;++y){var F=H[y];i(H[y]).appendTo(E)}}}G.tablesorter({cssInfoBlock:"tablesorter-no-sort"}).stickyTableHeaders({scrollableArea:B})}function i(x){var w=x.valueType==="double"||x.valueType==="float";var z=w||typeof x.value==="number"||x.valueType==="int"||x.valueType==="long";var y=x.value;if(w){y=x.value!==null?x.value.toFixed(3):(x.rawValue==="NaN"?"N/A":x.rawValue)}var A=c("<td/>").text(y);if(x.cssClass){A.addClass(x.cssClass)}if(z){A.css("text-align","right")}return A}function b(D,E){D.append(c("<h3 class='chart_title'/>").text(E.title)).append(c("<h4 class='chart_subtitle'/>").text(E.subtitle));var G=c("<table class='chart_table JmeterSummaryChart'/>").appendTo(D);var x=c("<tr/>").appendTo(c("<thead/>").appendTo(G));for(var B=0;B<E.columnLabels.length;++B){c("<th/>").text(E.columnLabels[B]).appendTo(x)}var A=c("<tbody/>").appendTo(G);for(var B=0;B<E.rows.length;++B){var F=c("<tr/>").appendTo(A);for(var z=0;z<E.rows[B].length;++z){var y=E.rows[B][z];var w=c("<td/>").text(y).appendTo(F);if(z>0){if(z===7&&y>0){w.addClass("JmeterSummaryChart_error")}else{if(z===2){var C=parseFloat(y);if(isNaN(C)||C>=5000){w.addClass("JmeterSummaryChart_error")}}}}}}G.tablesorter()}function m(w,A){if(!A._prepared){A._prepared=true;for(var z=0;z<A.series.length;++z){var y=A.series[z];y._index=z;y._chartIndex=A._index;y._reportIndex=A._reportIndex;y._showLines=y.lines&&y.lines.show===false?false:true;y._showBars=y.bars&&y.bars.show===true?true:false;y._showPoints=y.points&&y.points.show===true?true:false}}w.append(c("<h3 class='chart_title'/>").text(A.title)).append(c("<h4 class='chart_subtitle'/>").text(A.subtitle));var x=c("<div class='placeholder'/>").appendTo(w);c("<div class='x_label'/>").text(A.xLabel).appendTo(w);var C=c("<div class='legend'/>").appendTo(w);var B=f(x,C,A);g(x);k(c("<div class='chart_controls_pad'/>").appendTo(w),A)}function e(y,x){var A=y;var z=Math.abs(y);var w=Math.round(y);var B=Math.abs(y-w);if(z!=0&&(z>=1000000||y<=0.00001)){A=y.toExponential()}else{if(B>=0.00001){A=y.toFixed(1)}else{if(B>0){A=w}}}return A}function f(D,z,C,y){if(!C.yaxes){C.yaxes=[];C.yaxesMap=[];for(var A=0;A<C.series.length;++A){var G=C.series[A];var E=G._unit&&G._unit.value?G._unit.value:C.yLabel;if(!C.yaxesMap[E]){C.yaxes.push({position:C.yaxes.length&1?"right":"left",axisLabel:E});G.yaxis=C.yaxesMap[E]=C.yaxes.length}else{G.yaxis=C.yaxesMap[E]}}}var F={yaxes:C.yaxes,yaxis:{axisLabel:C.yLabel,minTickSize:0.1,tickFormatter:e},legend:{position:"nw",margin:[0,0],noColumns:5,container:z,labelFormatter:d},selection:{mode:"xy"},series:{lines:{show:true},points:{show:true,radius:1,lineWidth:0,fill:1,fillColor:false}},shadowSize:0,crosshair:{mode:"xy"},grid:{hoverable:true,clickable:true}};if(y){F=y(F)}switch(C.xaxisMode){case"TIME":F.xaxis={mode:"time"};break;case"CATEGORIES":var w=[];for(var A=0;A<C.series.length;++A){var x=C.series[A].data[0];x[0]=A;w.push(C.series[A].label)}F.xaxis={minTickSize:1,tickSize:1,tickLength:0,tickFormatter:function(J,I){var H=w[J];return H?"<div class='category_tick'>"+w[J]+"</div>":""}};F.series.bars={show:true,align:"center",barWidth:0.8,horizontal:false,lineWidth:0,fill:0.75,fillColor:false};F.series.points.show=false;break;case"NUMBER":break;case"INTEGER":F.xaxis={minTickSize:1,tickSize:1};if(C.xaxisTicks){F.xaxis.ticks=C.xaxisTicks}else{F.xaxis.tickFormatter=function(I,H){return Math.round(I)}}break;default:break}var B=c.plot(D,C.series,F);D.data("plot",B);D.data("chart",C);C.plot=B;if(C.xaxisMode==="CATEGORIES"){t(D)}return B}function k(w,x){c('<input type="button" value="show all"/>').click(function(){j(x,false)}).appendTo(w);c('<input type="button" value="hide all"/>').click(function(){j(x,true)}).appendTo(w)}function j(z,y){for(var x=0;x<z.series.length;++x){var w=z.series[x];if(!w.lines){w.lines={}}w.lines.show=y?false:w.showLines;if(!w.bars){w.bars={}}w.bars.show=y?false:w.showBars;if(!w.points){w.points={}}w.points.show=y?false:w.showPoints;w._show=y?false:true}p(z.plot.getPlaceholder(),z.plot,z,true)}function p(w,z,x,y){if(x){z.setData(x.series)}if(!y){z.setupGrid()}z.draw();if(w.data("chart").xaxisMode==="CATEGORIES"){t(w)}}function t(x){var z=x.data("chart");var y=x.find(".category_tick");var w=0;y.each(function(A,C){var D=c(C),B=D.width();if(w<B){w=B}D.css("margin-top",B);D.css("margin-left",-D.height()/2)});x.css("padding-bottom",w)}function d(x,y){var w=true;if(y._show===false){w=false}return'<a class="'+(w?"series_label_shown":"series_label_hidden")+'" onclick="ChartGeneration.eventHandlers.toggleSeries(this, '+y._reportIndex+", "+y._chartIndex+", "+y._index+');">'+x+"</a>"}function r(){c(".control_pad").html("");var x=ChartGeneration.compositeReport;x.title="";x._index=-1;if(!x.charts){x.charts=[{title:"Composite Chart",subtitle:"",xaxisMode:"TIME"}]}var z=x.charts[0];z.series=[];z.yaxes=[];z.yaxesMap={};z.xaxisTicks=null;l(c(".report"),x);var w=c(".control_pad");var y=c(".placeholder");c(".chart").addClass("composite_chart");n(y,w)}function o(){var C=c(this);var F=C.data("tag");var z=ChartGeneration.compositeReport.charts[0];var A=z.series;var D=z.yaxesMap;var w=z.yaxes;var E=F.line;var B=E._unit&&E._unit.value?F.chart.yLabel+" ("+E._unit.value+")":F.chart.yLabel;var x=D[B];if(C.is(":checked")){if(!x){w.push({position:w.length&1?"right":"left",axisLabel:B,_used:0});x=D[B]=w.length}++w[x-1]._used;A.push({label:F.chart.subtitle?F.chart.subtitle+"-"+E.label:E.label,data:E.data,yaxis:x,color:F.index});z.xaxisMode=F.chart.xaxisMode;if(z.xaxisMode==="INTEGER"){z.xaxisTicks=F.chart.xaxisTicks}}else{for(var y=0;y<A.length;++y){if(A[y].data===E.data){A.splice(y,1);break}}if(--w[x-1]._used<=0){for(var y=x;y<w.length;++y){w[y].position=w[y].position=="right"?"left":"right";--D[w[y].axisLabel];w[y-1]=w[y]}D[B]=0;w.pop();for(var y=0;y<A.length;++y){if(A[y].yaxis>x){--A[y].yaxis}}}}f(F.$placeholder,F.$legend,z,function(G){G.yaxesMap=D;G.yaxes=w;return G})}function a(){var y=c(this);var w=y.data("$placeholder");var x=ChartGeneration.compositeReport.charts[0];x.series=[];x.yaxes=[];x.yaxesMap={};x.xaxisTicks=null;c(".cb_control_pad").prop("checked",false);p(w,w.data("plot"),x)}function n(J,z){var H=ChartGeneration.data;var B=c("<div/>").appendTo(z);c("<button>Clear Selection</button>").data("$placeholder",J).click(a).appendTo(B);c("<input type='text' placeholder='caption'/>").change(function(){c(".composite_chart .chart_title").text(this.value?this.value:ChartGeneration.compositeReport.title)}).appendTo(B);c("<input type='text' placeholder='description' />").change(function(){c(".composite_chart .chart_subtitle").text(this.value?this.value:ChartGeneration.compositeReport.subtitle)}).appendTo(B);var x=c("<dl/>").appendTo(z);var K=0;for(var F=0;F<H.length;++F){var C=H[F];c("<dt/>").text(C.title).appendTo(x);var G=C.charts;for(var A=0;A<G.length;++A){var I=G[A];if(I.xaxisMode==="CATEGORIES"){continue}if(I.xaxisMode==="INTEGER"){ChartGeneration.compositeReport.xaxisMode=null}var E=c("<dl/>");c("<dd/>").append(E).appendTo(x);c("<dt/>").text(I.title).appendTo(E);var D=I.series;if(!D){continue}for(var y=0;y<D.length;++y){var L=D[y];var w=c("<input type='checkbox' class='cb_control_pad'/>").data("tag",{report:C,chart:I,line:L,$placeholder:J,$legend:J.nextAll(".legend"),index:K++}).change(o);c("<dd/>").append(c("<label/>").text(L.label).prepend(w)).appendTo(E)}}}}function g(w){w.off();w.bind("plotselected",function(C,x){var E=w.data("plot");var y=E.getXAxes();for(var z=0;z<y.length;){var B=y[z++].options;var A=z>1?x["x"+z+"axis"]:x.xaxis;if(!A){continue}B.min=A.from;B.max=A.to}var D=E.getYAxes();for(var z=0;z<D.length;){var B=D[z++].options;var A=z>1?x["y"+z+"axis"]:x.yaxis;if(!A){continue}B.min=A.from;B.max=A.to}p(w,E,w.data("chart"));E.clearSelection()});w.bind("plothover",function(C,F,B){var A=w.data("chart");if(B){var z;switch(B.series.xaxis.options.mode){case"time":z=new Date(B.datapoint[0]).toUTCString();break;default:switch(A.xaxisMode){case"CATEGORIES":z=B.series.label;break;default:z=B.datapoint[0];if(A.xaxisTicks){var D=s(A.xaxisTicks,z);if(D){z=D}}break}break}var E=B.datapoint[1].toFixed(3);if(B.series._unit&&B.series._unit.value){E+=" "+B.series._unit.value}c("#tooltip").html("<b>"+B.series.label+"</b><br />"+z+"<br />"+E).css({top:B.pageY+5,left:B.pageX+5}).fadeIn(200)}else{c("#tooltip").hide()}});w.bind("dblclick",function(){u(w)});w.bind("plotclick",function(x,E,F){if(F){var D=w.data("chart");var y=D.series[F.seriesIndex];var z=D._interactive=!D._interactive;for(var A=0;A<D.series.length;++A){var B=D.series[A];var C=A!=F.seriesIndex&&z;if(!B.lines){B.lines={}}B.lines.show=C?false:B.showLines;if(!B.bars){B.bars={}}B.bars.show=C?false:B.showBars;if(!B.points){B.points={}}B.points.show=C?false:B.showPoints;B._show=!C}p(D.plot.getPlaceholder(),D.plot,D,true)}})}function s(B,w){var y=0,A=B.length-1;while(y<=A){var z=y+((A-y)>>1);if(B[z][0]==w){return B[z][1]}if(B[z][0]<w){y=z+1}else{A=z-1}}return null}function u(w){var x=w.data("plot");c.each(x.getXAxes(),function(y,z){var A=z.options;A.min=A.max=null});c.each(x.getYAxes(),function(y,z){var A=z.options;A.min=A.max=null});p(w,x,null)}function q(){c("<div id='tooltip'></div>").css({position:"absolute",display:"none",border:"1px solid #fdd",padding:"2px","background-color":"#fee",opacity:0.8}).appendTo("body");c("h1").text("Perf-test Report");var z=ChartGeneration.data;var A=c("#report_nav");for(var x=0;x<z.length;++x){var w=z[x];var y=c("<a class='report_switch' href='javascript:'/>").text(w.title).data("report-index",x).click(function(){c(".control_pad").html("");h(c(this).data("report-index"))});A.append(c("<li/>").append(y))}c("<li/>").append(c("<a class='report_switch' href='javascript:'>Composite Chart</a>").click(function(){r()})).appendTo(A)}c(function(){q();h(0)})}ChartGeneration(jQuery);