function ChartGeneration(c){ChartGeneration.eventHandlers={toggleSeries:function(D,F,B,A){if(F===undefined||F<0){return}var E=ChartGeneration.data[F].charts[B];var C=E.series[A];var z=false;if(C._show===false){z=true}C._show=z;if(!C.lines){C.lines={show:true}}C.lines.show=z?C._showLines:false;if(!C.bars){C.bars={show:false}}C.bars.show=z?C._showBars:false;if(!C.points){C.points={show:false}}C.points.show=z?C._showPoints:false;r(E.plot.getPlaceholder(),E.plot,E,true)}};ChartGeneration.data=[];ChartGeneration.compositeReport={};function j(z){var A=ChartGeneration.data;if(z>=A.length){return}A[z]._index=z;n(c(".report"),A[z])}function n(F,z){F.children(".report_title").text(z.title);var E=F.children(".charts");var D=z.charts;E.html("");for(var B=0;B<D.length;++B){var C=D[B];var A=c("<div class='chart'/>");E.append(A);C._index=B;C._reportIndex=z._index;if(C.chartType==="JmeterSummaryChart"){b(A,C)}else{if(C.chartType==="TABLE"){x(A,C)}else{if(C.xaxisMode==="BAR_STRING"){y(A,C)}else{o(A,C)}}}}}function x(F,G){F.append(c("<h3 class='chart_title'/>").text(G.title)).append(c("<h4 class='chart_subtitle'/>").text(G.subtitle));var D=c("<div class='chart_table_container'>").appendTo(F);var K=c("<table class='chart_table'/>").appendTo(D);if(G.key){K.attr("data-key",G.key)}if(G.header){var z=c("<tr/>").appendTo(c("<thead/>").appendTo(K));for(var C=0;C<G.header.length;++C){c("<th/>").text(G.header[C]).appendTo(z)}}if(G.topRows){var E=c('<tbody class="tablesorter-no-sort"/>').appendTo(K);for(var C=0;C<G.topRows.length;++C){var I=c("<tr/>").appendTo(E);var L=G.topRows[C];for(var B=0;B<L.length;++B){var J=L[B];k(L[B]).appendTo(I)}}}if(G.rows){var A=c("<tbody/>").appendTo(K);for(var C=0;C<G.rows.length;++C){var I=c("<tr/>").appendTo(A);var L=G.rows[C];for(var B=0;B<L.length;++B){var J=L[B];k(L[B]).appendTo(I)}}}if(G.bottomRows){var H=c('<tbody class="tablesorter-no-sort"/>').appendTo(K);for(var C=0;C<G.bottomRows.length;++C){var I=c("<tr/>").appendTo(H);var L=G.bottomRows[C];for(var B=0;B<L.length;++B){var J=L[B];k(L[B]).appendTo(I)}}}K.tablesorter({cssInfoBlock:"tablesorter-no-sort"}).stickyTableHeaders({scrollableArea:D})}function k(A){var z=A.valueType==="double"||A.valueType==="float";var C=z||typeof A.value==="number"||A.valueType==="int"||A.valueType==="long";var B=A.value;if(z){B=A.value!==null?A.value.toFixed(3):(A.rawValue==="NaN"?"N/A":A.rawValue)}var D=c("<td/>").text(B);if(A.cssClass){D.addClass(A.cssClass)}if(C){D.css("text-align","right")}return D}function b(G,H){G.append(c("<h3 class='chart_title'/>").text(H.title)).append(c("<h4 class='chart_subtitle'/>").text(H.subtitle));var J=c("<table class='chart_table JmeterSummaryChart'/>").appendTo(G);var A=c("<tr/>").appendTo(c("<thead/>").appendTo(J));for(var E=0;E<H.columnLabels.length;++E){c("<th/>").text(H.columnLabels[E]).appendTo(A)}var D=c("<tbody/>").appendTo(J);for(var E=0;E<H.rows.length;++E){var I=c("<tr/>").appendTo(D);for(var C=0;C<H.rows[E].length;++C){var B=H.rows[E][C];var z=c("<td/>").text(B).appendTo(I);if(C>0){if(C===7&&B>0){z.addClass("JmeterSummaryChart_error")}else{if(C===2){var F=parseFloat(B);if(isNaN(F)||F>=5000){z.addClass("JmeterSummaryChart_error")}}}}}}J.tablesorter()}function h(B){if(!B._prepared){B._prepared=true;for(var A=0;A<B.series.length;++A){var z=B.series[A];z._index=A;z._chartIndex=B._index;z._reportIndex=B._reportIndex;z._showLines=z.lines&&z.lines.show===false?false:true;z._showBars=z.bars&&z.bars.show===true?true:false;z._showPoints=z.points&&z.points.show===true?true:false}}}function y(I,J){h(J);I.append(c("<h3 class='chart_title'/>").text(J.title)).append(c("<h4 class='chart_subtitle'/>").text(J.subtitle));var K=c("<div class='placeholder'/>").appendTo(I);c("<div class='x_label'/>").text(J.xLabel).appendTo(I);var D=c("<div class='legend'/>").appendTo(I);var H=f(K,D,J);i(K);var B=c("<div class='chart_controls_pad'/>").appendTo(I);var F=c("<ul class='chart_group_list' style='max-height:100px; overflow:scroll'/>").appendTo(B);for(var E in J.stringMap){var L=J.stringMap[E];var C=c("<li style='display:inline-block; width:20%;word-wrap: break-word;'/>").appendTo(F);var G=c("<label/>").appendTo(C);var A=c("<input type='checkbox' class='cb_bar_group_selector' />").data("tag",{sid:E,chart:J}).prop("checked",J._isGroupShowMap[E]).change(g).appendTo(G);c("<span/>").text(L).appendTo(G)}var z=c("<div class='chart_bar_show_hide_all' />").appendTo(B);c("<input type='button' value='clear selection' />").click(function(){c(".cb_bar_group_selector").prop("checked",false);J.series=[];J._isGroupShowMap={};r(H.getPlaceholder(),H,J,true)}).appendTo(z);c("<input type='button' value='select all' />").click(function(){c(".cb_bar_group_selector").prop("checked",true);J._isGroupShowMap={};for(var N in J.stringMap){J._isGroupShowMap[N]=true}v(J,J.plot.getOptions());var M=H.getXAxes()[0].options;M._zoomed=false;M.min=H.getOptions().xaxis.min;M.max=H.getOptions().xaxis.max;r(H.getPlaceholder(),H,J,false)}).appendTo(z)}function g(G){var F=c(G.target);var D=F.is(":checked");var z=F.data("tag");var B=z.chart;var C=B._isGroupShowMap;var E=B.plot;C[z.sid]=D;v(B,E.getOptions());var A=E.getXAxes()[0].options;A._zoomed=false;A.min=E.getOptions().xaxis.min;A.max=E.getOptions().xaxis.max;r(E.getPlaceholder(),E,B,false)}function v(L,A){var G=L._rawSeries?L._rawSeries:L.series;var T=L.stringMap;var D;if(!L._isGroupShowMap){D=L._isGroupShowMap={};var F=0;for(var J in T){if(++F>10){break}D[J]=true}}else{D=L._isGroupShowMap}var K=1/(G.length+1);var I=1-K;var C=[];var H={};var B={};var R=0;for(var Q=0;Q<G.length;Q++){var M=G[Q];if(!M._showBars){continue}var N={label:M.label,_showBars:M._showBars,_showPoints:M._showPoints,_showLines:M._showLines,color:Q+1,data:[]};for(var P=0;P<M.data.length;P++){var O=M.data[P];var E=O[0];if(D[E]!==true){continue}var z;if(H[E]===undefined){z=H[E]=++R;B[R]=E}else{z=H[E]}var S=z+K*Q;N.data.push([S,O[1]])}C.push(N)}L._groupId2RawXMap=B;L._barWidth=K;L._rawSeries=G;L.series=C;if(A){if(!A.xaxis){A.xaxis={}}A.xaxis.min=1-L._barWidth;A.xaxis.max=R+0.9}}function o(z,B){h(B);z.append(c("<h3 class='chart_title'/>").text(B.title)).append(c("<h4 class='chart_subtitle'/>").text(B.subtitle));var A=c("<div class='placeholder'/>").appendTo(z);c("<div class='x_label'/>").text(B.xLabel).appendTo(z);var D=c("<div class='legend'/>").appendTo(z);var C=f(A,D,B);i(A);m(c("<div class='chart_controls_pad'/>").appendTo(z),B)}function e(C,F){var E,G,I,A=C<0,D;if(F.tickSize>=1){E=Math.round(C).toString();D=E.length}else{if(F.tickSize>=0.1){E=C.toFixed(1);D=E.length-2}else{E=C.toFixed(2);D=E.length-3}}var z=A?1:0;G=D-z;if(G<=3){return E}I=A?"-":"";for(var B=z;B<D;++B){I+=E[B];var H=D-1-B;if(H&&!(H%3)){I+=","}}return I+E.substring(D)}function f(H,D,G,C){if(!G.yaxes){G.yaxes=[];G.yaxesMap=[];for(var E=0;E<G.series.length;++E){var L=G.series[E];var I=L._unit&&L._unit.value?L._unit.value:G.yLabel;if(!G.yaxesMap[I]){G.yaxes.push({position:G.yaxes.length&1?"right":"left",axisLabel:I});L.yaxis=G.yaxesMap[I]=G.yaxes.length}else{L.yaxis=G.yaxesMap[I]}}}var K={yaxes:G.yaxes,yaxis:{axisLabel:G.yLabel,minTickSize:0.01,tickFormatter:e},legend:{position:"nw",margin:[0,0],noColumns:5,container:D,labelFormatter:d},selection:{mode:"xy"},series:{lines:{show:true},points:{show:true,radius:1,lineWidth:0,fill:1,fillColor:false}},shadowSize:0,crosshair:{mode:"xy"},grid:{hoverable:true,clickable:true}};var B=G._rawSeries?G._rawSeries:G.series;if(C){K=C(K)}switch(G.xaxisMode){case"TIME":K.xaxis={mode:"time"};break;case"CATEGORIES":var z=[];for(var E=0;E<G.series.length;++E){var A=G.series[E].data[0];A[0]=E;z.push(G.series[E].label)}K.xaxis={minTickSize:1,tickSize:1,tickLength:0,tickFormatter:function(P,O){var N=z[P];if(!N){return""}var M="<div class='category_tick'>";for(var Q=0;Q<N.length;Q++){M+N[Q]+"<br/>"}return M+"</div>"}};K.series.bars={show:true,align:"center",barWidth:0.8,horizontal:false,lineWidth:0,fill:0.75,fillColor:false};K.series.points.show=false;break;case"BAR_STRING":var J=1/(B.length+1);v(G,K);K.series.lines.show=false;K.series.points.show=false;K.xaxis={min:K.xaxis.min,max:K.xaxis.max,minTickSize:1,tickSize:1,tickLength:10,tickFormatter:function(O,N){var M=G.stringMap[G._groupId2RawXMap[O]];if(!M){return""}return"<div class='category_tick'>"+M+"</div>"},labelWidth:100};K.series.bars={show:true,align:"left",barWidth:G._barWidth,horizontal:false,lineWidth:0,fill:0.8,fillColor:false};break;case"INTEGER":K.xaxis={minTickSize:1,tickSize:1};if(G.xaxisTicks){K.xaxis.ticks=G.xaxisTicks}else{K.xaxis.tickFormatter=function(N,M){return Math.round(N)}}break;default:break}var F=c.plot(H,G.series,K);H.data("plot",F);H.data("chart",G);G.plot=F;return F}function m(z,A){c('<input type="button" value="show all"/>').click(function(){l(A,false)}).appendTo(z);c('<input type="button" value="hide all"/>').click(function(){l(A,true)}).appendTo(z)}function l(C,B){for(var A=0;A<C.series.length;++A){var z=C.series[A];if(!z.lines){z.lines={}}z.lines.show=B?false:z.showLines;if(!z.bars){z.bars={}}z.bars.show=B?false:z.showBars;if(!z.points){z.points={}}z.points.show=B?false:z.showPoints;z._show=B?false:true}r(C.plot.getPlaceholder(),C.plot,C,true)}function r(z,C,A,B){if(A){C.setData(A.series)}if(!B){C.setupGrid()}C.draw()}function d(A,B){var z=true;if(B._show===false){z=false}return'<a class="'+(z?"series_label_shown":"series_label_hidden")+'" onclick="ChartGeneration.eventHandlers.toggleSeries(this, '+B._reportIndex+", "+B._chartIndex+", "+B._index+');">'+A+"</a>"}function t(){c(".control_pad").html("");var A=ChartGeneration.compositeReport;A.title="";A._index=-1;if(!A.charts){A.charts=[{title:"Composite Chart",subtitle:"",xaxisMode:"TIME"}]}var C=A.charts[0];C.series=[];C.yaxes=[];C.yaxesMap={};C.xaxisTicks=null;n(c(".report"),A);var z=c(".control_pad");var B=c(".placeholder");c(".chart").addClass("composite_chart");p(B,z)}function q(){var F=c(this);var I=F.data("tag");var C=ChartGeneration.compositeReport.charts[0];var D=C.series;var G=C.yaxesMap;var z=C.yaxes;var H=I.line;var E=H._unit&&H._unit.value?I.chart.yLabel+" ("+H._unit.value+")":I.chart.yLabel;var A=G[E];if(F.is(":checked")){if(!A){z.push({position:z.length&1?"right":"left",axisLabel:E,_used:0});A=G[E]=z.length}++z[A-1]._used;D.push({label:I.chart.subtitle?I.chart.subtitle+"-"+H.label:H.label,data:H.data,yaxis:A,color:I.index});C.xaxisMode=I.chart.xaxisMode;if(C.xaxisMode==="INTEGER"){C.xaxisTicks=I.chart.xaxisTicks}}else{for(var B=0;B<D.length;++B){if(D[B].data===H.data){D.splice(B,1);break}}if(--z[A-1]._used<=0){for(var B=A;B<z.length;++B){z[B].position=z[B].position=="right"?"left":"right";--G[z[B].axisLabel];z[B-1]=z[B]}G[E]=0;z.pop();for(var B=0;B<D.length;++B){if(D[B].yaxis>A){--D[B].yaxis}}}}f(I.$placeholder,I.$legend,C,function(J){J.yaxesMap=G;J.yaxes=z;return J})}function a(){var B=c(this);var z=B.data("$placeholder");var A=ChartGeneration.compositeReport.charts[0];A.series=[];A.yaxes=[];A.yaxesMap={};A.xaxisTicks=null;c(".cb_control_pad").prop("checked",false);r(z,z.data("plot"),A)}function p(M,C){var K=ChartGeneration.data;var E=c("<div/>").appendTo(C);c("<button>Clear Selection</button>").data("$placeholder",M).click(a).appendTo(E);c("<input type='text' placeholder='caption'/>").change(function(){c(".composite_chart .chart_title").text(this.value?this.value:ChartGeneration.compositeReport.title)}).appendTo(E);c("<input type='text' placeholder='description' />").change(function(){c(".composite_chart .chart_subtitle").text(this.value?this.value:ChartGeneration.compositeReport.subtitle)}).appendTo(E);var A=c("<dl/>").appendTo(C);var N=0;for(var I=0;I<K.length;++I){var F=K[I];c("<dt/>").text(F.title).appendTo(A);var J=F.charts;for(var D=0;D<J.length;++D){var L=J[D];if(L.xaxisMode==="CATEGORIES"){continue}if(L.xaxisMode==="INTEGER"){ChartGeneration.compositeReport.xaxisMode=null}var H=c("<dl/>");c("<dd/>").append(H).appendTo(A);c("<dt/>").text(L.title).appendTo(H);var G=L.series;if(!G){continue}for(var B=0;B<G.length;++B){var O=G[B];var z=c("<input type='checkbox' class='cb_control_pad'/>").data("tag",{report:F,chart:L,line:O,$placeholder:M,$legend:M.nextAll(".legend"),index:N++}).change(q);c("<dd/>").append(c("<label/>").text(O.label).prepend(z)).appendTo(H)}}}}function i(z){z.off();z.bind("plotselected",function(F,A){var H=z.data("plot");var B=H.getXAxes();for(var C=0;C<B.length;){var E=B[C++].options;var D=C>1?A["x"+C+"axis"]:A.xaxis;if(!D){continue}if(!E._zoomed){E._min=E.min?E.min:null;E._max=E.max?E.max:null;E._zoomed=true}E.min=D.from;E.max=D.to}var G=H.getYAxes();for(var C=0;C<G.length;){var E=G[C++].options;var D=C>1?A["y"+C+"axis"]:A.yaxis;if(!D){continue}if(!E._zoomed){E._min=E.min?E.min:null;E._max=E.max?E.max:null;E._zoomed=true}E.min=D.from;E.max=D.to}r(z,H,z.data("chart"));H.clearSelection()});z.bind("plothover",function(D,G,C){var B=z.data("chart");if(C){var A;switch(C.series.xaxis.options.mode){case"time":A=new Date(C.datapoint[0]).toUTCString();break;default:A=C.datapoint[0];switch(B.xaxisMode){case"CATEGORIES":A=C.series.label;break;case"BAR_STRING":if(B._groupId2RawXMap&&B.stringMap){A=B.stringMap[B._groupId2RawXMap[Math.floor(A)]]}break;default:if(B.xaxisTicks){var E=u(B.xaxisTicks,A);if(E){A=E}}break}break}var F=C.datapoint[1].toFixed(3);if(C.series._unit&&C.series._unit.value){F+=" "+C.series._unit.value}c("#tooltip").html("<b>"+C.series.label+"</b><br />"+A+"<br />"+F).css({top:C.pageY+5,left:C.pageX+5}).fadeIn(200)}else{c("#tooltip").hide()}});z.bind("dblclick",function(){w(z)});z.bind("plotclick",function(A,H,I){if(I){var G=z.data("chart");var B=G.series[I.seriesIndex];var C=G._interactive=!G._interactive;for(var D=0;D<G.series.length;++D){var E=G.series[D];var F=D!=I.seriesIndex&&C;if(!E.lines){E.lines={}}E.lines.show=F?false:E.showLines;if(!E.bars){E.bars={}}E.bars.show=F?false:E.showBars;if(!E.points){E.points={}}E.points.show=F?false:E.showPoints;E._show=!F}r(G.plot.getPlaceholder(),G.plot,G,true)}})}function u(D,z){var A=0,C=D.length-1;while(A<=C){var B=A+((C-A)>>1);if(D[B][0]==z){return D[B][1]}if(D[B][0]<z){A=B+1}else{C=B-1}}return null}function w(z){var A=z.data("plot");c.each(A.getXAxes(),function(B,C){var D=C.options;if(D._zoomed){D.min=D._min;D.max=D._max;D._zoomed=false}});c.each(A.getYAxes(),function(B,C){var D=C.options;if(D._zoomed){D.min=D._min;D.max=D._max;D._zoomed=false}});r(z,A,null)}function s(){c("<div id='tooltip'></div>").css({position:"absolute",display:"none",border:"1px solid #fdd",padding:"2px","background-color":"#fee",opacity:0.8}).appendTo("body");c("h1").text("Perf-test Report");var C=ChartGeneration.data;var D=c("#report_nav");for(var A=0;A<C.length;++A){var z=C[A];var B=c("<a class='report_switch' href='javascript:'/>").text(z.title).data("report-index",A).click(function(){c(".control_pad").html("");j(c(this).data("report-index"))});D.append(c("<li/>").append(B))}c("<li/>").append(c("<a class='report_switch' href='javascript:'>Composite Chart</a>").click(function(){t()})).appendTo(D)}c(function(){s();j(0)})}ChartGeneration(jQuery);